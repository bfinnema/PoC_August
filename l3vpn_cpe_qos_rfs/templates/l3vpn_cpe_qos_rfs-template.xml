<config-template xmlns="http://tail-f.com/ns/config/1.0">
  <devices xmlns="http://tail-f.com/ns/ncs">
    <device>
      <name>{/device}</name>
      <config>
        <class-map xmlns="urn:ios">
          <name>Video</name>
          <prematch>match-all</prematch>
          <match>
            <ip>
              <dscp>af41</dscp>
            </ip>
          </match>
        </class-map>
        <class-map xmlns="urn:ios">
          <name>Voice</name>
          <prematch>match-all</prematch>
          <match>
            <ip>
              <dscp>ef</dscp>
            </ip>
          </match>
        </class-map>
        <policy-map xmlns="urn:ios">
          <name>CPE-Parent-Policy</name>
          <class-default>
            <class>
              <name>class-default</name>
              <shape>
                <average>
                  <bit-rate>10240000</bit-rate>
                  <!-- <bit-rate>{/bit_rate}</bit-rate> -->
                </average>
              </shape>
              <service-policy>CPE-Policy</service-policy>
            </class>
          </class-default>
        </policy-map>
        <policy-map xmlns="urn:ios">
          <name>CPE-Policy</name>
          <class>
            <name>Voice</name>
            <police-rate-percent>
              <police>
                <rate>
                  <percent>
                    <percentage>25</percentage>
                  </percent>
                </rate>
              </police>
            </police-rate-percent>
            <priority/>
            <queue-limit>
              <queue-limit-value>12</queue-limit-value>
              <queue-limit-type>packets</queue-limit-type>
            </queue-limit>
            <set>
              <cos>
                <val>5</val>
              </cos>
            </set>
          </class>
          <class>
            <name>Video</name>
            <bandwidth>
              <percent>30</percent>
            </bandwidth>
            <queue-limit>
              <queue-limit-value>24</queue-limit-value>
              <queue-limit-type>packets</queue-limit-type>
            </queue-limit>
            <set>
              <cos>
                <val>4</val>
              </cos>
            </set>
          </class>
          <class-default>
            <class>
              <name>class-default</name>
              <bandwidth>
                <percent>45</percent>
              </bandwidth>
              <queue-limit>
                <queue-limit-value>512</queue-limit-value>
                <queue-limit-type>packets</queue-limit-type>
              </queue-limit>
              <set>
                <cos>
                  <val>0</val>
                </cos>
              </set>
            </class>
          </class-default>
        </policy-map>
        <interface xmlns="urn:ios">
          <GigabitEthernet>
            <name>{/interface/interface_number}.{/vlan_id}</name>
            <service-policy>
              <output>CPE-Parent-Policy</output>
            </service-policy>
          </GigabitEthernet>
        </interface>
      </config>
    </device>
  </devices>
</config-template>
